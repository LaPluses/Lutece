{% extends "base/base.html" %}


{% block extra_head %}
    <link href="{{ static('css/problem/problem_list.css') }}" rel="stylesheet" />
{% endblock extra_head %}

{% block content%}

<div class = 'problem list'>

    <div class = 'ui two column grid'>

        <div class = 'column'>

            <div class="ui pagination menu">

                <a class="icon item" href = {{ url('problem-list-view' , args = (1,) ) }} ><i class="angle double left icon"></i></a>
                {% for it in page_list %}
                    {% if it == currentpage %}
                        <a class="active item" href = {{ url('problem-list-view' , args = (it,) ) }}  >{{it}}</a>
                    {% else %}
                        <a class="item" href = {{ url('problem-list-view' , args = (it,) ) }}  >{{it}}</a>
                    {% endif %}
                {% endfor %}
                <a class="icon item" href = {{ url('problem-list-view' , args = (max_page,) ) }} ><i class="angle double right icon"></i></a>

            </div>
        
        </div>

        <div class = 'column'>
            {% if perms.problem.add_problem %}
                <div style = 'float:right' >
                    <div class = 'ui primary edit button'><i class = 'add icon'></i><b>New</b></div>
                </div>
            {% endif %}

            <div class="ui search" style = 'float:right;'>
                <div class="ui left icon input" >
                    <input class="prompt" type="text" placeholder="Search">
                    <i class="search icon"></i>
                </div>
            </div>

        </div>

    </div>

    <table class = "ui basic fixed selectable padded table bordered" >
        <thread>
            <tr>
                <th>ID</th>
                <th>Title</th>
                {% if user.is_authenticated == True %}
                    <th>Status</th>
                {% endif %}
                <th>Solve / Try</th>
                <th>AC Ratio</th>
            </tr>
        </thread>
        <tbody>
                {% for it in problist %}
                <tr>
                    <td>{{it.problem_id}} </td>
                    <td><a href = {{ url('problem-detail-view' , args = (it.problem_id,) ) }} >{{it.title}}</td>
                    {% if user.is_authenticated == True %}
                        <td>
                            {% if user_analysis[ loop.index0 ] == 2 %}
                                <i class="green checkmark icon"></i>
                            {% elif user_analysis[ loop.index0 ] == 1 %}
                                 <i class = 'red times icon'> </i>
                            {% endif %}
                        </td>
                    {% endif %}
                    <td>{{ problem_analysis[ loop.index0 ].0 }} / {{ problem_analysis[ loop.index0 ].1 }} </td>
                    {% if problem_analysis[ loop.index0 ].1 == 0 %}
                        <td> 0.00% </td>
                    {% else %}
                        <td> {{ "%.2f" | format( problem_analysis[ loop.index0 ].0 / problem_analysis[ loop.index0 ].1 * 100 ) }} %</td>
                    {% endif %}
                </tr>
                {% endfor %}
        </tbody>
    </table>
</div>

<script>
    $('.problem.list .ui.search')
        .search({
            apiSettings: {
                url: '//api.github.com/search/repositories?q={query}'
            },
            fields: {
                results : 'items',
                title   : 'name',
                url     : 'html_url'
            },
            minCharacters : 3
        })
    ;
</script>
{% endblock %}