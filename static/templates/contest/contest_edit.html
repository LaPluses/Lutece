{% extends "base/base.html" %}

{% block extra_head %}
    <link href="{{ static('css/contest/contest_edit.css') }}" rel="stylesheet" />
    <script type="text/javascript" src="{{ static('/katex/dist/katex.min.js') }}"></script>
    <script type="text/javascript" src="{{ static('/katex/dist/contrib/auto-render.min.js') }}"></script>
    <link rel="stylesheet" href="{{ static('/katex/dist/katex.min.css') }}"/>
    <script type="text/javascript" src="{{ static('/markdown/dist/marked.min.js') }}"></script>        
    <link href="{{ static('semantic/dist/calendar/calendar.min.css') }}" rel="stylesheet" />
    <script type="text/javascript" src="{{ static('semantic/dist/calendar/calendar.min.js') }}"></script>
{% endblock extra_head %}

{% block content %}

    <div class = 'ui modal' id = 'admin-add-modal' style = 'min-height:100px;width:600px;'>
        <div class = 'header' style = 'text-align:center;color:#2185d0;' > <i class = 'user secret icon'></i> Edit Contest Admin </div>
        <div class = 'content'>
            <div class = 'admin'>
                <div class="ui medium image label">
                    <img src= {{ gravatar_url( email = user.email , size = 200 ) }} />
                    Adrienne
                    <i class="delete icon"></i>
                </div>
            </div>

            <div class = 'ui divider'></div>

            <div>
                <span id = 'user-search' class="ui category search" >
                    <div class="ui left icon input" >
                        <input class="prompt" type="text" placeholder="User">
                        <i class="search icon"></i>
                    </div>
                </span>
                <span class = 'ui medium secondary button'> Apply </span>
            </div>
        </div>


        <div class="actions">
            <div class="ui positive right labeled icon button" id = 'create-contest-button'>
                Confirm
                <i class="chevron right icon"></i>
            </div>
        </div>
    </div>

    <div class = 'contest edit'>
        <div class = 'ui grid'>

            <div class = 'row'>
                <div class = 'column'>
                    <h1 class="ui aligned center header">Contest {{ contest.pk }} </h1>
                </div>
            </div>

            <div class = 'row'>
                <div class = 'column'>
                    <div class="ui large label">Title</div>
                    <div class = 'ui fluid input'>
                        <input id = 'title-input' type = "text" value = '{{ contest.title }}' maxlength = "64">
                    </div>
                </div>
            </div>

            <div class = 'row'>
                <div class = 'column'>
                    <div>
                        <label class="ui large label">ContestType</label>
                    </div>
                    <div class="ui fluid selection dropdown" id = 'contest-type'>
                        <input type = "hidden" value = '{{ contesttypelist.0.value.full }}'>
                        <i class="dropdown icon"></i>
                        <i class = 'university icon'></i>
                        <div class="text">{{ contesttypelist.0.value.full }}</div>
                        <div class="menu">
                            {% for each in contesttypelist %}
                                <div class = 'item' >{{ each.value.full }}</div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <div class = 'row'>
                <div class = 'column'>
                    <label class="ui large label">StartTime</label>
                    <div class="ui calendar" id = 'start-time' >
                        <div class="ui fluid input left icon">
                            <i class = 'calendar icon'> </i>
                            <input type="text" placeholder='Start time' >
                        </div>
                    </div>
                </div>
            </div>

            <div class = 'row'>
                <div class = 'column'>
                    <label class="ui large label">EndTime</label>
                    <div class="ui calendar" id = 'end-time' >
                        <div class="ui fluid input left icon">
                            <i class = 'calendar icon'> </i>
                            <input type="text" placeholder='End time' >
                        </div>
                    </div>
                </div>
            </div>


            <div class = 'row'>
                <div class = 'column'>
                    <label class="ui large label">Password</label>
                    <div data-tooltip = "Live blank will make the contest public" data-position="top left" class="ui left icon fluid password input">
                        <i class="lock icon"></i>
                        <input id = "contest-pwd" type="password" name="password" placeholder="Password" value = '{{ contest.password }}'  maxlength = 32 >
                    </div>
                </div>
            </div>

            <div class = 'row'>
                <div class = 'column'>
                    <div id = "visible-checkbox" class="ui toggle checkbox">
                        <input type="checkbox" tabindex="0" class="hidden">
                        <label> <b>Visible</b> </label>
                    </div>
                </div>
            </div>

            <div class = 'row'>
                <div class = 'column'>
                    <div id = "invite-checkbox" class="ui toggle checkbox">
                        <input type="checkbox" tabindex="0" class="hidden">
                        <label> <b>Invite</b> </label>
                    </div>
                </div>
            </div>

            <div class = 'row'>
                <div class = 'column'>
                    <div id = 'add-admin-button' class = 'ui positive right labeled icon button'>
                        EditContestAdmin
                        <i class="chevron right icon"></i>
                    </div>
                </div>
            </div>


            <div class = 'row'>
                <div class = 'eight wide column'>
                    <div class = 'ui form'>
                        <div class="ui large label">Note</div>
                        <textarea style = 'width:100%;height:200px;' id = "note-textarea">{{ contest.note }}</textarea>
                    </div>
                </div>
                <div class = 'eight wide column'>
                    <div class="ui large label">Note Preview</div>
                    <div id = "note-textarea-render" style = 'width:100%;height:auto;min-height:200px;margin-top:0;' class="ui render fluid container raised segment"></div>
                </div>
            </div>

            <div class = 'row'>
                <div class = 'column'>
                    <div id = "submit-form" class = 'ui primary button' style = 'display:block;' >Submit</div>
                </div>
            </div>

        </div>
    </div>

    <script>
        Pewview( 'note-textarea' , 'note-textarea-render' );
        $('#visible-checkbox').checkbox();
        $('#invite-checkbox').checkbox();
        {%  if contest.visible == True %}
            $('#visible-checkbox').checkbox( 'set checked' );
        {% endif %}
        {%  if contest.invite == True %}
            $('#invite-checkbox').checkbox( 'set checked' );
        {% endif %}
        $('#contest-type').dropdown();
        $('#start-time,#end-time').calendar();
        let base_start_time = new Date('{{ contest.start_time }}');
        let base_end_time = new Date( '{{ contest.end_time}}');
        $('#start-time').calendar( 'set date' , base_start_time );
        $('#end-time').calendar( 'set date' , base_end_time );
        $('#add-admin-button').click(function(){
            $('#admin-add-modal').modal( 'show' );})
    </script>
{% endblock content %}