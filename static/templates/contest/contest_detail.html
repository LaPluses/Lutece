{% extends "base/base.html" %}

{% block extra_head %}
    <script type="text/javascript" src="{{ static('/katex/dist/katex.min.js') }}"></script>
    <script type="text/javascript" src="{{ static('/katex/dist/contrib/auto-render.min.js') }}"></script>
    <link rel="stylesheet" href="{{ static('/katex/dist/katex.min.css') }}"/>
    <script type="text/javascript" src="{{ static('/markdown/dist/marked.min.js') }}"></script>    
{% endblock extra_head %}

{% block content %}
    <div class = 'contest detail'>
        <div class = 'ui one column grid'>

            <div class = 'column'>
                <h1 style = 'text-align:center'> {{ contest.title }} </h1>
            </div>

            <div class = 'column'>
                <div class = "ui indicating progress" id = 'runtime-progress' >
                    <div class = "bar">
                        <div class="progress"></div>
                    </div>
                    <div class = "label" style = 'font-size:16px;' >
                        <i class = '{{ conteststatus.value.icon }}' style = 'color:{{ conteststatus.value.color }};' ></i> <span style = 'color:{{ conteststatus.value.color }};'><b>{{ conteststatus.value.full }}</b></span>
                    </div>
                </div>
            </div>

            <div class = 'column'>

            </div>

        </div>
    </div>

    <script>
        var start_time = new Date('{{ contest.start_time }}');
        var end_time = new Date('{{ contest.end_time}}' );
        var total = parseInt({{ (contest.end_time - contest.start_time).total_seconds() }});
        var cur = Math.min( total , parseInt({{ (now - contest.start_time).total_seconds() }}) );
        $('#runtime-progress').progress( 'set total' , total );
        {% if conteststatus.value.full != 'Pending' %}
            $('#runtime-progress')
                .progress({
                    label: 'ratio',
                    text: {
                        ratio: '{value}'
                    }
                })
            ;
            function UpdateTimer(){
                $('#runtime-progress').progress( 'set progress' , cur );
                return;
                if( $('#runtime-progress').progress( 'is success' ) ){
                     {% if conteststatus.value.full == 'Running' %}
                        alert( gtmd );
                        //location.reload();
                    {% endif %}
                }else{
                    cur = cur + 1;
                    setTimeout( "UpdateTimer()" , 1000 );
                }
            }
            UpdateTimer();
        {% endif %}
    </script>
{% endblock content %}